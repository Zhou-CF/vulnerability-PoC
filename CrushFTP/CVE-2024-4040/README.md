# CVE-2024-4040 - exploit scanners

>CrushFTP是由CrushFTP LLC开发的文件传输服务器软件，主要用途是提供安全、可靠的文件传输服务，允许用户通过多种协议安全地上传、下载和管理文件。

This repository contains files related to [CVE-2024-4040](https://nvd.nist.gov/vuln/detail/CVE-2024-4040) (CrushFTP VFS escape).

## scan_host.py

This script attempts to use the vulnerability to read files outside the sandbox. If it succeeds, the script writes `Vulnerable` to standard output and returns with exit code 1. If exploiting the vulnerability does not succeed, the script writes `Not vulnerable` and exits with status code 0.

The script depends on the [`requests`](https://requests.readthedocs.io/en/latest/) library.

## scan_logs.py

This script looks for indicators of compromise in a CrushFTP server installation directory. It is basically equivalent to running the following command:

```
$ grep -F -r '<INCLUDE>' /path/to/CrushFTP/logs/
```

For each match, it will attempt to extract the IP which tried to exploit the server.

## 来源

[https://github.com/airbus-cert/CVE-2024-4040](https://github.com/airbus-cert/CVE-2024-4040)

## 简介

CrushFTP存在服务器端模板注入漏洞，未经身份验证的远程攻击者可以逃避虚拟文件系统沙箱，绕过身份验证获得管理访问权限，泄露敏感信息或执行代码。

## 漏洞类型

模板注入

## 影响范围

-   CrushFTP v10 < 10.7.1
-   CrushFTP v11 < 11.1.0
-   CrushFTP v7
-   CrushFTP v8
-   CrushFTP v9

## 参考连接

[https://www.bleepingcomputer.com/news/security/crushftp-warns-users-to-patch-exploited-zero-day-immediately/](https://www.bleepingcomputer.com/news/security/crushftp-warns-users-to-patch-exploited-zero-day-immediately/)

[https://www.bleepingcomputer.com/news/security/exploit-for-crushftp-rce-chain-released-patch-now/](https://www.bleepingcomputer.com/news/security/exploit-for-crushftp-rce-chain-released-patch-now/)

## 免责声明

由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。
