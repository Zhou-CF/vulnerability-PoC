# CVE-2024-22024
Check for CVE-2024-22024 vulnerability in Ivanti Connect Secure

> Ivanti ICS&Ivanti Policy Secure 是 Ivanti 公司提供的终端安全和网络访问控制解决方案。
>
> [!WARNING]
> FOR EDUCATIONAL PURPOSE AND AUTHORIZED TESTING ONLY.

## 来源

[https://github.com/0dteam/CVE-2024-22024](https://github.com/0dteam/CVE-2024-22024)

## 漏洞简介

Ivanti Pulse Connect Secure VPN存在XXE漏洞，攻击者可构造恶意请求触发XXE，结合相关功能造成远程代码执行。

## 漏洞类型

XXE

## 影响范围

-   ivanti connect_secure 22.4
-   ivanti connect_secure 22.5
-   ivanti connect_secure 9.1
-   ivanti policy_secure 22.5
-   ivanti zero_trust_access 22.6

## POC

### Parameters

- `-u` or `--target_url`: The target Ivanti Connect Secure (ICS) URL or file with list of URLs.

- `-c` or `--attacker_url`: The attacker URL (generate one using Burp Collaborator, ngrok, or by using a unique URL from [Webhook.site](https://webhook.site))

- `-t` or `--timeout`: Timeout in seconds for the request (default is 3 seconds)


### How to use
Testing a single URL:

`python .\cve_2024_22024.py -u http://vpn.example.com -c http://potatodynamicdns.oastify.com`

Testing list of URLs:

`python .\cve_2024_22024.py -u .\urls_list.txt -c http://potatodynamicdns.oastify.com`

Using a different timeout (5 seconds):

`python .\cve_2024_22024.py -u .\urls_list.txt -c http://potatodynamicdns.oastify.com -t 5`

## Credits
Whoever discovered the vulnerability .. I just read the PoC and automated this.

[0dteam website](https://www.0d.ae)
